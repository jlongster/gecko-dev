(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./test", "immutable", "../record", "../typed"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./test"), require("immutable"), require("../record"), require("../typed"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.test, global.Immutable, global.record, global.typed);
    global.record = mod.exports;
  }
})(this, function (exports, _test, _immutable, _record, _typed) {
  "use strict";

  var Point = (0, _record.Record)({
    x: Number(0),
    y: Number(0)
  }, "Point");

  (0, _test["default"])("reading record short-cirquits", function (assert) {
    var v = Point();
    var reader = (0, _typed.typeOf)(Point);

    assert.equal(reader[_typed.Typed.read](v), v);
  });

  (0, _test["default"])("reading records", function (assert) {
    var reader = (0, _typed.typeOf)(Point);

    var v1 = reader[_typed.Typed.read]();
    var v2 = reader[_typed.Typed.read]({ x: 10 });
    var v3 = reader[_typed.Typed.read]({ y: 10 });
    var v4 = reader[_typed.Typed.read]({ x: 1, y: 2 });

    assert.ok(v1 instanceof _record.Record);
    assert.ok(v2 instanceof _record.Record);
    assert.ok(v3 instanceof _record.Record);
    assert.ok(v4 instanceof _record.Record);

    assert.ok(v1 instanceof Point);
    assert.ok(v2 instanceof Point);
    assert.ok(v3 instanceof Point);
    assert.ok(v4 instanceof Point);

    assert.deepEqual(v1.toJSON(), { x: 0, y: 0 });
    assert.deepEqual(v2.toJSON(), { x: 10, y: 0 });
    assert.deepEqual(v3.toJSON(), { x: 0, y: 10 });
    assert.deepEqual(v4.toJSON(), { x: 1, y: 2 });
  });

  var identity = function identity(x) {
    return x;
  };
  (0, _test["default"])("identical on no change", function (assert) {
    var p1 = Point({ x: 5 });

    assert.equal(p1, p1.set('x', 5));
    assert.equal(p1, p1.merge({ x: 5 }));
    assert.equal(p1, p1.merge({ y: 0 }));
    assert.equal(p1, p1.merge({ x: 5, y: 0 }));
    assert.equal(p1, p1.remove('y'));
    assert.equal(p1, p1.update('x', identity));
    assert.equal(p1, p1.update('y', identity));
  });

  (0, _test["default"])("identical no change in deep updates", function (assert) {
    var Line = (0, _record.Record)({ start: Point, end: Point }, 'Line');

    var l1 = Line({ start: { x: 5 }, end: { x: 7, y: 2 } });

    assert.equal(l1, l1.set('start', l1.start));
    assert.equal(l1, l1.set('end', l1.end));

    assert.equal(l1, l1.merge({ start: l1.start }));
    assert.equal(l1, l1.merge({ end: l1.end }));
    assert.equal(l1, l1.merge({ start: l1.start, end: l1.end }));
    assert.equal(l1, l1.removeIn(['start', 'y']));
    assert.equal(l1, l1.setIn(['start', 'x'], 5));
    assert.equal(l1, l1.setIn(['start', 'x'], 5).setIn(['end', 'x'], 7));
    assert.equal(l1, l1.mergeIn(['start'], { x: 5 }));
    assert.equal(l1, l1.mergeIn(['start'], { x: 5, y: 0 }));
    assert.equal(l1, l1.mergeIn(['start'], { y: 0 }));
    assert.equal(l1, l1.mergeIn(['end'], { y: 2 }));
    assert.equal(l1, l1.mergeIn(['end'], { x: 7 }));
    assert.equal(l1, l1.mergeIn(['end'], { y: 2, x: 7 }));

    assert.equal(l1, l1.update('start', function (p) {
      return p.set('x', 5);
    }));
  });

  (0, _test["default"])('empty record optimization', function (assert) {
    var Point = (0, _record.Record)({ x: 0, y: 0 }, 'Point');

    assert.equal(Point(), Point());
    assert.notEqual(Point({ x: 1 }), Point());
    assert.equal(Point({ x: 1 }).clear(), Point());
    assert.equal(Point({ x: 1 }).clear(), Point({ y: 2 }).clear());
    assert.equal(Point({}), Point());
    assert.notEqual(Point({ z: 3 }), Point());
    assert.ok(Point({ z: 3 }).equals(Point()));
    assert.notEqual(Point({ x: 0 }), Point());
    assert.ok(Point({ x: 0 }).equals(Point()));
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZXN0L3JlY29yZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFLQSxNQUFNLEtBQUssR0FBRyxZQUhOLE1BQU0sRUFHTztBQUNuQixLQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNaLEtBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDO0dBQ2IsRUFBRSxPQUFPLENBQUMsQ0FBQTs7QUFFWCx3QkFBSywrQkFBK0IsRUFBRSxVQUFBLE1BQU0sRUFBSTtBQUM5QyxRQUFNLENBQUMsR0FBRyxLQUFLLEVBQUUsQ0FBQTtBQUNqQixRQUFNLE1BQU0sR0FBRyxXQVRGLE1BQU0sRUFTRyxLQUFLLENBQUMsQ0FBQTs7QUFFNUIsVUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FYZCxLQUFLLENBV2UsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7R0FDdkMsQ0FBQyxDQUFBOztBQUdGLHdCQUFLLGlCQUFpQixFQUFFLFVBQUEsTUFBTSxFQUFJO0FBQ2hDLFFBQU0sTUFBTSxHQUFHLFdBaEJGLE1BQU0sRUFnQkcsS0FBSyxDQUFDLENBQUE7O0FBRTVCLFFBQU0sRUFBRSxHQUFHLE1BQU0sQ0FBQyxPQWxCWixLQUFLLENBa0JhLElBQUksQ0FBQyxFQUFFLENBQUE7QUFDL0IsUUFBTSxFQUFFLEdBQUcsTUFBTSxDQUFDLE9BbkJaLEtBQUssQ0FtQmEsSUFBSSxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLENBQUMsQ0FBQTtBQUNyQyxRQUFNLEVBQUUsR0FBRyxNQUFNLENBQUMsT0FwQlosS0FBSyxDQW9CYSxJQUFJLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxFQUFFLEVBQUMsQ0FBQyxDQUFBO0FBQ3JDLFFBQU0sRUFBRSxHQUFHLE1BQU0sQ0FBQyxPQXJCWixLQUFLLENBcUJhLElBQUksQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQTs7QUFFekMsVUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLG9CQXhCTixNQUFNLEFBd0JrQixDQUFDLENBQUE7QUFDL0IsVUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLG9CQXpCTixNQUFNLEFBeUJrQixDQUFDLENBQUE7QUFDL0IsVUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLG9CQTFCTixNQUFNLEFBMEJrQixDQUFDLENBQUE7QUFDL0IsVUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLG9CQTNCTixNQUFNLEFBMkJrQixDQUFDLENBQUE7O0FBRS9CLFVBQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxZQUFZLEtBQUssQ0FBQyxDQUFBO0FBQzlCLFVBQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxZQUFZLEtBQUssQ0FBQyxDQUFBO0FBQzlCLFVBQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxZQUFZLEtBQUssQ0FBQyxDQUFBO0FBQzlCLFVBQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxZQUFZLEtBQUssQ0FBQyxDQUFBOztBQUU5QixVQUFNLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLENBQUE7QUFDeEMsVUFBTSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLEVBQUUsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxDQUFBO0FBQ3pDLFVBQU0sQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxFQUFFLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRSxFQUFDLENBQUMsQ0FBQTtBQUN6QyxVQUFNLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLENBQUE7R0FDekMsQ0FBQyxDQUFBOztBQUdGLE1BQU0sUUFBUSxHQUFHLFNBQVgsUUFBUSxDQUFHLENBQUM7V0FBSSxDQUFDO0dBQUEsQ0FBQTtBQUN2Qix3QkFBSyx3QkFBd0IsRUFBRSxVQUFBLE1BQU0sRUFBSTtBQUN2QyxRQUFJLEVBQUUsR0FBRyxLQUFLLENBQUMsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQzs7QUFFdkIsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNqQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQztBQUNuQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQztBQUNuQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3pDLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNqQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO0FBQzNDLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7R0FDNUMsQ0FBQyxDQUFBOztBQUVGLHdCQUFLLHFDQUFxQyxFQUFFLFVBQUEsTUFBTSxFQUFJO0FBQ3BELFFBQUksSUFBSSxHQUFHLFlBdkRMLE1BQU0sRUF1RE0sRUFBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQTs7QUFFckQsUUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUMsS0FBSyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLEdBQUcsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFDLENBQUMsQ0FBQTs7QUFFakQsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUE7QUFDM0MsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7O0FBRXZDLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssRUFBQyxDQUFDLENBQUMsQ0FBQTtBQUM3QyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLEVBQUMsQ0FBQyxDQUFDLENBQUE7QUFDekMsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUMsR0FBRyxFQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzFELFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzdDLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUM3QyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUN4QixLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUMzQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFBO0FBQy9DLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQTtBQUNyRCxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFBO0FBQy9DLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUE7QUFDN0MsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQTtBQUM3QyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUE7O0FBRW5ELFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQUEsQ0FBQzthQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztLQUFBLENBQUMsQ0FBQyxDQUFBO0dBQ3pELENBQUMsQ0FBQTs7QUFHRix3QkFBSywyQkFBMkIsRUFBRSxVQUFBLE1BQU0sRUFBSTtBQUMxQyxRQUFNLEtBQUssR0FBRyxZQWpGUixNQUFNLEVBaUZTLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFDLEVBQUUsT0FBTyxDQUFDLENBQUE7O0FBRTNDLFVBQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQTtBQUM5QixVQUFNLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUE7QUFDdkMsVUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFBO0FBQzVDLFVBQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQTtBQUMxRCxVQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFBO0FBQ2hDLFVBQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQTtBQUN2QyxVQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUE7QUFDeEMsVUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFBO0FBQ3RDLFVBQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQTtHQUN6QyxDQUFDLENBQUMiLCJmaWxlIjoicmVjb3JkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHRlc3QgZnJvbSBcIi4vdGVzdFwiXG5pbXBvcnQgKiBhcyBJbW11dGFibGUgZnJvbSBcImltbXV0YWJsZVwiXG5pbXBvcnQge1JlY29yZH0gZnJvbSBcIi4uL3JlY29yZFwiXG5pbXBvcnQge1R5cGVkLCB0eXBlT2YsIFVuaW9uLCBNYXliZX0gZnJvbSBcIi4uL3R5cGVkXCJcblxuY29uc3QgUG9pbnQgPSBSZWNvcmQoe1xuICB4OiBOdW1iZXIoMCksXG4gIHk6IE51bWJlcigwKVxufSwgXCJQb2ludFwiKVxuXG50ZXN0KFwicmVhZGluZyByZWNvcmQgc2hvcnQtY2lycXVpdHNcIiwgYXNzZXJ0ID0+IHtcbiAgY29uc3QgdiA9IFBvaW50KClcbiAgY29uc3QgcmVhZGVyID0gdHlwZU9mKFBvaW50KVxuXG4gIGFzc2VydC5lcXVhbChyZWFkZXJbVHlwZWQucmVhZF0odiksIHYpXG59KVxuXG5cbnRlc3QoXCJyZWFkaW5nIHJlY29yZHNcIiwgYXNzZXJ0ID0+IHtcbiAgY29uc3QgcmVhZGVyID0gdHlwZU9mKFBvaW50KVxuXG4gIGNvbnN0IHYxID0gcmVhZGVyW1R5cGVkLnJlYWRdKClcbiAgY29uc3QgdjIgPSByZWFkZXJbVHlwZWQucmVhZF0oe3g6MTB9KVxuICBjb25zdCB2MyA9IHJlYWRlcltUeXBlZC5yZWFkXSh7eToxMH0pXG4gIGNvbnN0IHY0ID0gcmVhZGVyW1R5cGVkLnJlYWRdKHt4OjEsIHk6Mn0pXG5cbiAgYXNzZXJ0Lm9rKHYxIGluc3RhbmNlb2YgUmVjb3JkKVxuICBhc3NlcnQub2sodjIgaW5zdGFuY2VvZiBSZWNvcmQpXG4gIGFzc2VydC5vayh2MyBpbnN0YW5jZW9mIFJlY29yZClcbiAgYXNzZXJ0Lm9rKHY0IGluc3RhbmNlb2YgUmVjb3JkKVxuXG4gIGFzc2VydC5vayh2MSBpbnN0YW5jZW9mIFBvaW50KVxuICBhc3NlcnQub2sodjIgaW5zdGFuY2VvZiBQb2ludClcbiAgYXNzZXJ0Lm9rKHYzIGluc3RhbmNlb2YgUG9pbnQpXG4gIGFzc2VydC5vayh2NCBpbnN0YW5jZW9mIFBvaW50KVxuXG4gIGFzc2VydC5kZWVwRXF1YWwodjEudG9KU09OKCksIHt4OjAseTowfSlcbiAgYXNzZXJ0LmRlZXBFcXVhbCh2Mi50b0pTT04oKSwge3g6MTAseTowfSlcbiAgYXNzZXJ0LmRlZXBFcXVhbCh2My50b0pTT04oKSwge3g6MCx5OjEwfSlcbiAgYXNzZXJ0LmRlZXBFcXVhbCh2NC50b0pTT04oKSwge3g6MSx5OjJ9KVxufSlcblxuXG5jb25zdCBpZGVudGl0eSA9IHggPT4geFxudGVzdChcImlkZW50aWNhbCBvbiBubyBjaGFuZ2VcIiwgYXNzZXJ0ID0+IHtcbiAgdmFyIHAxID0gUG9pbnQoe3g6IDV9KTtcblxuICBhc3NlcnQuZXF1YWwocDEsIHAxLnNldCgneCcsIDUpKTtcbiAgYXNzZXJ0LmVxdWFsKHAxLCBwMS5tZXJnZSh7eDogNX0pKTtcbiAgYXNzZXJ0LmVxdWFsKHAxLCBwMS5tZXJnZSh7eTogMH0pKTtcbiAgYXNzZXJ0LmVxdWFsKHAxLCBwMS5tZXJnZSh7eDogNSwgeTogMH0pKTtcbiAgYXNzZXJ0LmVxdWFsKHAxLCBwMS5yZW1vdmUoJ3knKSk7XG4gIGFzc2VydC5lcXVhbChwMSwgcDEudXBkYXRlKCd4JywgaWRlbnRpdHkpKTtcbiAgYXNzZXJ0LmVxdWFsKHAxLCBwMS51cGRhdGUoJ3knLCBpZGVudGl0eSkpO1xufSlcblxudGVzdChcImlkZW50aWNhbCBubyBjaGFuZ2UgaW4gZGVlcCB1cGRhdGVzXCIsIGFzc2VydCA9PiB7XG4gIHZhciBMaW5lID0gUmVjb3JkKHtzdGFydDogUG9pbnQsIGVuZDogUG9pbnR9LCAnTGluZScpXG5cbiAgdmFyIGwxID0gTGluZSh7c3RhcnQ6IHt4OiA1fSwgZW5kOiB7eDogNywgeTogMn19KVxuXG4gIGFzc2VydC5lcXVhbChsMSwgbDEuc2V0KCdzdGFydCcsIGwxLnN0YXJ0KSlcbiAgYXNzZXJ0LmVxdWFsKGwxLCBsMS5zZXQoJ2VuZCcsIGwxLmVuZCkpXG5cbiAgYXNzZXJ0LmVxdWFsKGwxLCBsMS5tZXJnZSh7c3RhcnQ6IGwxLnN0YXJ0fSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2Uoe2VuZDogbDEuZW5kfSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2Uoe3N0YXJ0OiBsMS5zdGFydCwgZW5kOiBsMS5lbmR9KSlcbiAgYXNzZXJ0LmVxdWFsKGwxLCBsMS5yZW1vdmVJbihbJ3N0YXJ0JywgJ3knXSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEuc2V0SW4oWydzdGFydCcsICd4J10sIDUpKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLnNldEluKFsnc3RhcnQnLCAneCddLCA1KVxuICAgICAgICAgICAgICAgICAgICAgLnNldEluKFsnZW5kJywgJ3gnXSwgNykpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2VJbihbJ3N0YXJ0J10sIHt4OiA1fSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2VJbihbJ3N0YXJ0J10sIHt4OiA1LCB5OiAwfSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2VJbihbJ3N0YXJ0J10sIHt5OiAwfSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2VJbihbJ2VuZCddLCB7eTogMn0pKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLm1lcmdlSW4oWydlbmQnXSwge3g6IDd9KSlcbiAgYXNzZXJ0LmVxdWFsKGwxLCBsMS5tZXJnZUluKFsnZW5kJ10sIHt5OiAyLCB4OiA3fSkpXG5cbiAgYXNzZXJ0LmVxdWFsKGwxLCBsMS51cGRhdGUoJ3N0YXJ0JywgcCA9PiBwLnNldCgneCcsIDUpKSlcbn0pXG5cblxudGVzdCgnZW1wdHkgcmVjb3JkIG9wdGltaXphdGlvbicsIGFzc2VydCA9PiB7XG4gIGNvbnN0IFBvaW50ID0gUmVjb3JkKHt4OiAwLCB5OiAwfSwgJ1BvaW50JylcblxuICBhc3NlcnQuZXF1YWwoUG9pbnQoKSwgUG9pbnQoKSlcbiAgYXNzZXJ0Lm5vdEVxdWFsKFBvaW50KHt4OiAxfSksIFBvaW50KCkpXG4gIGFzc2VydC5lcXVhbChQb2ludCh7eDogMX0pLmNsZWFyKCksIFBvaW50KCkpXG4gIGFzc2VydC5lcXVhbChQb2ludCh7eDogMX0pLmNsZWFyKCksIFBvaW50KHt5OiAyfSkuY2xlYXIoKSlcbiAgYXNzZXJ0LmVxdWFsKFBvaW50KHt9KSwgUG9pbnQoKSlcbiAgYXNzZXJ0Lm5vdEVxdWFsKFBvaW50KHt6OiAzfSksIFBvaW50KCkpXG4gIGFzc2VydC5vayhQb2ludCh7ejogM30pLmVxdWFscyhQb2ludCgpKSlcbiAgYXNzZXJ0Lm5vdEVxdWFsKFBvaW50KHt4OjB9KSwgUG9pbnQoKSlcbiAgYXNzZXJ0Lm9rKFBvaW50KHt4OiAwfSkuZXF1YWxzKFBvaW50KCkpKVxufSk7XG4iXX0=